<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="baidu-site-verification" content="codeva-GMY6wDOV7M">
    <title>页面分类生成器 - 后室中文数据库</title>
    <link rel="icon" href="https://static.wikitide.net/backroomszhwiki/thumb/1/16/SiteLogo.png/400px-SiteLogo.png">
    <meta property="og:title" content="页面分类生成器 - 后室中文数据库">
    <meta property="og:url" content="https://wiki.backroomszh.org">
    <meta property="og:description" content="为后室中文数据库页面生成完整的wikitext分类代码">
    <meta property="og:image" content="https://static.wikitide.net/backroomszhwiki/thumb/1/16/SiteLogo.png/320px-SiteLogo.png">
    <meta property="og:image:alt" content="后室中文数据库站标">
    <meta property="article:tag" content="backrooms,后室,中文,分类生成器,wikitext,MediaWiki,后室中文维基">
    <meta property="og:locale" content="zh-CN">
    <meta property="og:site_name" content="后室中文数据库">
    <meta property="og:type" content="website">
    <style>
        /* 后室主题样式 */
        :root {
            --main-color: #fefc88;
            --accent-color: #d5f74b;
            --text-color: #e0e0e0;
            --card-bg: rgba(30, 30, 30, 0.85);
            --warning-color: #ff9966;
            --success-color: #99ff99;
            --danger-color: #ff6666;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(45deg, #1a1a1a, #2d2d2d);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* 背景图片容器 */
        #background {
            position: fixed;
            top: -10%;
            left: -10%;
            width: 120%;
            height: 120%;
            background: url('https://static.wikitide.net/backroomszhwiki/4/40/IMG_0407.jpeg') no-repeat center center/cover;
            z-index: -1;
            will-change: transform;
            filter: blur(2px);
        }

        /* 导航栏 */
        .nav {
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem;
            border-bottom: 1px solid var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 2;
            backdrop-filter: blur(5px);
        }

        .nav a {
            color: var(--text-color);
            text-decoration: none;
            margin: 0 1rem;
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.3);
            font-weight: 500;
        }

        .nav a:hover {
            color: var(--accent-color);
            text-shadow: 0 0 8px var(--accent-color);
            box-shadow: 0 0 15px var(--accent-color);
            background: rgba(0, 0, 0, 0.5);
            transform: scale(1.05);
        }

        .nav img {
            height: 40px;
            margin-right: 1rem;
            vertical-align: middle;
            filter: drop-shadow(0 0 5px var(--accent-color));
        }

        /* 主容器 */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .title {
            font-size: 2.5rem;
            text-shadow: 0 0 10px var(--accent-color);
            animation: flicker 3s infinite;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #aaa;
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        /* 内容卡片 */
        .card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: left;
        }

        .card-title {
            color: var(--accent-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 1.5rem;
            text-shadow: 0 0 5px var(--accent-color);
        }

        h3 {
            color: var(--text-color);
            margin: 15px 0 10px 0;
            font-size: 1.2rem;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }

        .checkbox-group, .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 10px;
        }

        .checkbox-item, .radio-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            transition: all 0.2s;
        }

        .checkbox-item:hover, .radio-item:hover {
            background: rgba(0, 0, 0, 0.5);
        }

        input[type="checkbox"], input[type="radio"] {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--accent-color);
        }

        label {
            cursor: pointer;
            font-weight: 500;
        }

        .required::after {
            content: " *";
            color: var(--danger-color);
        }

        .not-recommended {
            color: var(--warning-color);
            font-style: italic;
        }

        /* 输入框样式 */
        .special-input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            font-size: 1rem;
            margin-top: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: var(--text-color);
            transition: all 0.3s;
        }

        .special-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(213, 247, 75, 0.2);
        }

        textarea.special-input {
            min-height: 100px;
            resize: vertical;
        }

        .note {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 5px;
            font-style: italic;
        }

        .warning-note {
            color: var(--warning-color);
            background: rgba(255, 153, 102, 0.1);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            border-left: 4px solid var(--warning-color);
        }

        /* 结果区域 */
        .result-box {
            background: rgba(0, 0, 0, 0.7);
            color: var(--text-color);
            padding: 20px;
            border-radius: 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
            line-height: 1.5;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* 按钮样式 */
        .button-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 30px;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.5);
            color: var(--text-color);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .generate-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: 1px solid #3498db;
        }

        .generate-btn:hover {
            background: linear-gradient(45deg, #2980b9, #1c5a7a);
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
        }

        .copy-btn {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            border: 1px solid #2ecc71;
        }

        .copy-btn:hover {
            background: linear-gradient(45deg, #27ae60, #1e8449);
            box-shadow: 0 0 15px rgba(46, 204, 113, 0.5);
        }

        .reset-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            border: 1px solid #e74c3c;
        }

        .reset-btn:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.5);
        }

        /* 状态消息 */
        .status {
            text-align: center;
            padding: 10px;
            margin-top: 15px;
            border-radius: 4px;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .status.success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid #2ecc71;
            opacity: 1;
        }

        .status.error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid #e74c3c;
            opacity: 1;
        }

        .status.warning {
            background: rgba(255, 153, 102, 0.2);
            color: #ff9966;
            border: 1px solid #ff9966;
            opacity: 1;
        }

        /* 分类标签示例 */
        .category-example {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            padding: 3px 8px;
            margin: 2px 5px 2px 0;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--accent-color);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* 页脚 */
        footer {
            position: relative;
            z-index: 1;
            background: rgba(0, 0, 0, 0.7);
            text-align: center;
            padding: 1rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        footer a {
            color: var(--accent-color);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* 动画效果 */
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .card {
                padding: 15px;
            }
            
            .checkbox-group, .radio-group {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 300px;
            }
        }

        /* 隐藏元素 */
        .hidden {
            display: none !important;
        }

        /* 步骤指示器 */
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }

        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
        }

        .step.active {
            background: var(--accent-color);
            color: #000;
            box-shadow: 0 0 10px var(--accent-color);
        }

        .step.completed {
            background: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }

        /* 规则部分 */
        .rules {
            background: rgba(255, 204, 0, 0.1);
            border-left: 5px solid #ffcc00;
        }

        .rules ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .rules li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <!-- 背景图片容器 -->
    <div id="background"></div>

    <!-- 导航栏 -->
    <nav class="nav">
        <img src="https://static.wikitide.net/backroomszhwiki/thumb/1/16/SiteLogo.png/400px-SiteLogo.png" 
             style="height: 40px; margin-right: 1rem; vertical-align: middle;">
        <a href="https://wiki.backroomszh.org" target="_blank">返回数据库</a>
        <a href="#generator">分类生成器</a>
        <a href="#rules">分类规则</a>
    </nav>

    <div class="container">
        <h1 class="title">后室中文数据库分类生成器</h1>
        <p class="subtitle">为后室中文数据库文章生成完整的wikitext分类代码</p>
        
        <!-- 步骤指示器 -->
        <div class="step-indicator">
            <div class="step active" id="step1">1</div>
            <div class="step" id="step2">2</div>
            <div class="step" id="step3">3</div>
            <div class="step" id="step4">4</div>
        </div>

        <!-- 规则部分 -->
        <section id="rules" class="card rules">
            <h2 class="card-title">分类规则说明</h2>
            <p>在后室中文数据库，基础分类由以下几类组成：</p>
            <ul>
                <li><strong>页面基础类型</strong>：表明该文章介绍对象的基本类别。
                    <div class="category-example">[[Category:层级]]</div>
                    <div class="category-example">[[Category:物品]]</div>
                    <div class="category-example">[[Category:实体]]</div>
                    <div class="category-example">[[Category:组织]]</div>
                    <div class="category-example">[[Category:故事]]</div>
                    <div class="category-example">[[Category:中心页]]</div>
                </li>
                <li><strong>层群归属</strong>：表明该文章属于普通层群还是CN层群。
                    <div class="category-example">[[Category:普通层群]]</div>
                    <div class="category-example">[[Category:CN层群]]</div>
                    <p class="note">注意：中心页、故事和组织页面通常不需要层群归属，层级、物品和实体页面需要层群归属。</p>
                </li>
                <li><strong>对象分级</strong>：表明文章描述对象的属性和危险程度。
                    <div class="category-example">[[Category:生存难度0]]</div>
                    <div class="category-example">[[Category:物品等级1A]]</div>
                    <p class="note">根据页面基础类型选择合适的对象分级。</p>
                </li>
                <li><strong>特殊分类</strong>：由于其他理由应当添加的分类。
                    <p>如：由于文章隶属某一设定，需要按照该设定中心页的要求添加分类。</p>
                </li><br>
                <li>详情请查看<a href="https://wiki.backroomszh.org/The_Backrooms_Wiki:%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86%E5%8A%9E%E6%B3%95">这里</a></li>
            </ul>
        </section>

        <!-- 分类生成器 -->
        <section id="generator" class="card fade-in">
            <h2 class="card-title">分类生成器</h2>
            
            <!-- 步骤1: 页面基础类型 (Required) -->
            <div class="form-group" id="step1-section">
                <h3 class="required">1. 页面基础类型 <span class="note">(必选，单选)</span></h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="type-level" name="page-type" value="层级">
                        <label for="type-level">层级</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type-item" name="page-type" value="物品">
                        <label for="type-item">物品</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type-entity" name="page-type" value="实体">
                        <label for="type-entity">实体</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type-organization" name="page-type" value="组织">
                        <label for="type-organization">组织</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type-story" name="page-type" value="故事">
                        <label for="type-story">故事</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type-center" name="page-type" value="中心页">
                        <label for="type-center">中心页</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="type-center" name="page-type" value="中心页">
                        <label for="type-other">更多世界</label>
                    </div>
                </div>
            </div>

            <!-- 步骤2: 层群归属 -->
            <div class="form-group hidden" id="step2-section">
                <h3>2. 层群归属 <span class="note">(可选，可多选)</span></h3>
                <div id="cluster-warning" class="warning-note hidden">
                    <strong>注意：</strong>对于<span id="cluster-warning-type"></span>页面，通常不需要添加层群归属。
                </div>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="cluster-normal" name="cluster" value="普通层群">
                        <label for="cluster-normal">普通层群</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cluster-cn" name="cluster" value="CN层群">
                        <label for="cluster-cn">CN层群</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cluster-other" name="cluster" value="other">
                        <label for="cluster-other">其他层群</label>
                    </div>
                </div>
                <div id="other-cluster-container" class="hidden" style="margin-top: 15px;">
                    <input type="text" id="other-cluster-input" class="special-input" placeholder="请输入层群名称，例如：特殊层群">
                    <p class="note">只需输入层群名称，无需输入完整分类代码</p>
                </div>
            </div>

            <!-- 步骤3: 对象分级 -->
            <div class="form-group hidden" id="step3-section">
                <h3>3. 对象分级 <span class="note">(根据实际情况选择)</span></h3>
                <div id="classification-instructions" class="warning-note">
                    <p><strong>使用提示：</strong></p>
                    <ul style="margin-top: 5px; margin-bottom: 5px;">
                        <li><strong>层级</strong>：选择生存难度等级</li>
                        <li><strong>物品</strong>：选择物品等级</li>
                        <li><strong>实体</strong>：选择实体等级</li>
                        <li><strong>其他类型</strong>：通常不需要对象分级</li>
                    </ul>
                </div>
                
                <!-- Survival difficulty (for levels) -->
                <div id="survival-difficulty" class="classification-group hidden">
                    <h4>生存难度等级</h4>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="difficulty-0" name="difficulty" value="生存难度0">
                            <label for="difficulty-0">生存难度 0</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="difficulty-1" name="difficulty" value="生存难度1">
                            <label for="difficulty-1">生存难度 1</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="difficulty-2" name="difficulty" value="生存难度2">
                            <label for="difficulty-2">生存难度 2</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="difficulty-3" name="difficulty" value="生存难度3">
                            <label for="difficulty-3">生存难度 3</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="difficulty-4" name="difficulty" value="生存难度4">
                            <label for="difficulty-4">生存难度 4</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="difficulty-5" name="difficulty" value="生存难度5">
                            <label for="difficulty-5">生存难度 5</label>
                        </div>
                    </div>
                </div>
                
                <!-- Item classification -->
                <div id="item-classification" class="classification-group hidden">
                    <h4>物品等级</h4>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-0" name="item-class" value="物品等级0">
                            <label for="item-0">物品等级 0</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-1a" name="item-class" value="物品等级1A">
                            <label for="item-1a">物品等级 1A</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-1b" name="item-class" value="物品等级1B">
                            <label for="item-1b">物品等级 1B</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-2" name="item-class" value="物品等级2">
                            <label for="item-2">物品等级 2</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-3" name="item-class" value="物品等级3">
                            <label for="item-3">物品等级 3</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-4" name="item-class" value="物品等级4">
                            <label for="item-4">物品等级 4</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="item-5" name="item-class" value="物品等级5">
                            <label for="item-5">物品等级 5</label>
                        </div>
                    </div>
                </div>
                
                <!-- Entity classification -->
                <div id="entity-classification" class="classification-group hidden">
                    <h4>实体等级</h4>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="entity-0" name="entity-class" value="实体等级0">
                            <label for="entity-0">实体等级 0</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="entity-1" name="entity-class" value="实体等级1">
                            <label for="entity-1">实体等级 1</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="entity-2" name="entity-class" value="实体等级2">
                            <label for="entity-2">实体等级 2</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="entity-3" name="entity-class" value="实体等级3">
                            <label for="entity-3">实体等级 3</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="entity-4" name="entity-class" value="实体等级4">
                            <label for="entity-4">实体等级 4</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="entity-5" name="entity-class" value="实体等级5">
                            <label for="entity-5">实体等级 5</label>
                        </div>
                    </div>
                </div>
                
                <!-- Special classification input -->
                <div style="margin-top: 20px;">
                    <h4>特殊分级 <span class="note">(可选)</span></h4>
                    <input type="text" id="special-classification" class="special-input" placeholder="例如：生存难度N/A、物品等级Ω">
                    <p class="note">只需输入分级名称，无需输入完整分类代码</p>
                </div>
            </div>

            <!-- 步骤4: 特殊分类 -->
            <div class="form-group hidden" id="step4-section">
                <h3>4. 特殊分类 <span class="note">(可选)</span></h3>
                <p>由于其他理由应当添加的分类，例如文章隶属某一设定，需要按照该设定中心页的要求添加分类。</p>
                
                <div class="form-group">
                    <h4>特殊分类输入</h4>
                    <textarea id="special-categories" class="special-input" rows="4" placeholder="请输入特殊分类名称，每个分类一行或使用逗号分隔&#10;例如：&#10;特殊设定&#10;活动页面"></textarea>
                    <p class="note">只需输入分类名称，无需输入完整分类代码</p>
                </div>
                
                <div class="warning-note">
                    <p><strong>使用提示：</strong></p>
                    <ul style="margin-top: 5px; margin-bottom: 5px;">
                        <li>特殊分类通常是可选的，仅在页面属于特定设定或系列时需要添加</li>
                        <li>确保添加的分类与页面内容相关</li>
                        <li>如果不确定是否需要特殊分类，可以留空</li>
                    </ul>
                </div>
            </div>

            <!-- 导航按钮 -->
            <div class="button-group" id="navigation-buttons">
                <button class="reset-btn" id="prev-btn" style="display: none;">上一步</button>
                <button class="generate-btn" id="next-btn">下一步</button>
            </div>
        </section>

        <!-- 结果区域 -->
        <section id="result-section" class="card hidden fade-in">
            <h2 class="card-title">生成的分类代码</h2>
            <div class="result-box" id="result-code">
// 请选择分类选项，然后点击"生成分类代码"按钮
// 生成的内容将显示在这里
            </div>
            
            <div class="button-group">
                <button class="copy-btn" id="copy-btn">复制到剪贴板</button>
                <button class="reset-btn" id="reset-btn">重新开始</button>
            </div>
            
            <div class="status" id="status-message"></div>
        </section>
    </div>

    <footer>
        <small>
            <a href="https://wiki.backroomszh.org/Project:免责声明" target="_blank">免责声明</a> |
            <a href="mailto:example@backroomszh.org">站务邮箱</a><br>
            后室中文数据库 &copy; 2024 | MediaWiki分类生成器
        </small>
    </footer>

    <script>
        // DOM elements
        const generateBtn = document.getElementById('next-btn');
        const copyBtn = document.getElementById('copy-btn');
        const resetBtn = document.getElementById('reset-btn');
        const prevBtn = document.getElementById('prev-btn');
        const resultCode = document.getElementById('result-code');
        const statusMessage = document.getElementById('status-message');
        
        // Step elements
        const steps = document.querySelectorAll('.step');
        const stepSections = [
            document.getElementById('step1-section'),
            document.getElementById('step2-section'),
            document.getElementById('step3-section'),
            document.getElementById('step4-section'),
            document.getElementById('result-section')
        ];
        
        // Cluster affiliation elements
        const clusterOtherCheckbox = document.getElementById('cluster-other');
        const otherClusterContainer = document.getElementById('other-cluster-container');
        const otherClusterInput = document.getElementById('other-cluster-input');
        const clusterWarning = document.getElementById('cluster-warning');
        const clusterWarningType = document.getElementById('cluster-warning-type');
        
        // Page type radio buttons
        const pageTypeRadios = document.querySelectorAll('input[name="page-type"]');
        
        // Classification groups
        const survivalDifficulty = document.getElementById('survival-difficulty');
        const itemClassification = document.getElementById('item-classification');
        const entityClassification = document.getElementById('entity-classification');
        const classificationInstructions = document.getElementById('classification-instructions');
        
        // Special inputs
        const specialClassificationInput = document.getElementById('special-classification');
        const specialCategoriesInput = document.getElementById('special-categories');
        
        // Current step
        let currentStep = 1;
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize background animation
            animateBackground();
            
            // Initialize step indicators
            updateStepIndicator();
            
            // Page type change handler
            pageTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Update step 2 based on page type
                    updateStep2ForPageType();
                });
            });
            
            // Cluster other checkbox handler
            clusterOtherCheckbox.addEventListener('change', function() {
                otherClusterContainer.classList.toggle('hidden', !this.checked);
                if (!this.checked) {
                    otherClusterInput.value = '';
                }
            });
            
            // Navigation button handlers
            generateBtn.addEventListener('click', nextStep);
            prevBtn.addEventListener('click', prevStep);
            copyBtn.addEventListener('click', copyToClipboard);
            resetBtn.addEventListener('click', resetForm);
            
            // Initialize form
            updateStep2ForPageType();
        });
        
        // Background animation
        function animateBackground() {
            const background = document.getElementById('background');
            let posX = 0;
            let posY = 0;
            let speedX = 0.1;
            let speedY = 0.1;
            const maxX = 30;
            const maxY = 30;
            
            function animate() {
                posX += speedX;
                posY += speedY;
                
                if (posX > maxX || posX < -maxX) {
                    speedX = -speedX;
                }
                if (posY > maxY || posY < -maxY) {
                    speedY = -speedY;
                }
                
                background.style.transform = `translate(${posX}px, ${posY}px)`;
                requestAnimationFrame(animate);
            }
            
            animate();
        }
        
        // Update step 2 based on selected page type
        function updateStep2ForPageType() {
            const pageType = document.querySelector('input[name="page-type"]:checked');
            
            if (!pageType) {
                clusterWarning.classList.add('hidden');
                return;
            }
            
            // Show/hide warning for certain page types
            const type = pageType.value;
            const needsCluster = ['层级', '物品', '实体'].includes(type);
            const notRecommended = ['中心页', '故事', '组织', '更多世界'].includes(type);
            
            if (notRecommended) {
                clusterWarningType.textContent = type;
                clusterWarning.classList.remove('hidden');
            } else {
                clusterWarning.classList.add('hidden');
            }
            
            // Update classification instructions
            updateClassificationInstructions(type);
        }
        
        // Update classification instructions based on page type
        function updateClassificationInstructions(pageType) {
            let instructions = '';
            
            switch(pageType) {
                case '层级':
                    instructions = '<p><strong>使用提示：</strong></p><ul style="margin-top: 5px; margin-bottom: 5px;"><li><strong>层级</strong>：选择生存难度等级</li><li>其他类型：通常不需要对象分级</li></ul>';
                    break;
                case '物品':
                    instructions = '<p><strong>使用提示：</strong></p><ul style="margin-top: 5px; margin-bottom: 5px;"><li><strong>物品</strong>：选择物品等级</li><li>其他类型：通常不需要对象分级</li></ul>';
                    break;
                case '实体':
                    instructions = '<p><strong>使用提示：</strong></p><ul style="margin-top: 5px; margin-bottom: 5px;"><li><strong>实体</strong>：选择实体等级</li><li>其他类型：通常不需要对象分级</li></ul>';
                    break;
                default:
                    instructions = '<p><strong>使用提示：</strong></p><ul style="margin-top: 5px; margin-bottom: 5px;"><li><strong>层级</strong>：选择生存难度等级</li><li><strong>物品</strong>：选择物品等级</li><li><strong>实体</strong>：选择实体等级</li><li><strong>其他类型</strong>：通常不需要对象分级</li></ul>';
            }
            
            classificationInstructions.innerHTML = instructions;
            
            // Show/hide appropriate classification group
            survivalDifficulty.classList.add('hidden');
            itemClassification.classList.add('hidden');
            entityClassification.classList.add('hidden');
            
            // Uncheck all classification checkboxes
            document.querySelectorAll('.classification-group input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });
            
            // Show appropriate classification group
            if (pageType === '层级') {
                survivalDifficulty.classList.remove('hidden');
            } else if (pageType === '物品') {
                itemClassification.classList.remove('hidden');
            } else if (pageType === '实体') {
                entityClassification.classList.remove('hidden');
            }
        }
        
        // Next step function
        function nextStep() {
            // Validate current step
            if (!validateStep(currentStep)) {
                return;
            }
            
            // Hide current step
            stepSections[currentStep - 1].classList.add('hidden');
            
            // Move to next step
            currentStep++;
            
            // If we're at the last step, generate the code
            if (currentStep === 5) {
                generateCategories();
                stepSections[4].classList.remove('hidden');
                generateBtn.textContent = '完成';
                generateBtn.style.display = 'none';
                prevBtn.style.display = 'inline-block';
            } else {
                // Show next step
                stepSections[currentStep - 1].classList.remove('hidden');
                
                // Update button text
                if (currentStep === 4) {
                    generateBtn.textContent = '生成分类代码';
                }
                
                // Show prev button from step 2 onwards
                if (currentStep > 1) {
                    prevBtn.style.display = 'inline-block';
                }
            }
            
            // Update step indicator
            updateStepIndicator();
        }
        
        // Previous step function
        function prevStep() {
            // Hide current step
            if (currentStep === 5) {
                stepSections[4].classList.add('hidden');
            } else {
                stepSections[currentStep - 1].classList.add('hidden');
            }
            
            // Move to previous step
            currentStep--;
            
            // Show previous step
            stepSections[currentStep - 1].classList.remove('hidden');
            
            // Update button text
            if (currentStep < 4) {
                generateBtn.style.display = 'inline-block';
                generateBtn.textContent = '下一步';
            }
            
            // Hide prev button if at step 1
            if (currentStep === 1) {
                prevBtn.style.display = 'none';
            }
            
            // Update step indicator
            updateStepIndicator();
        }
        
        // Validate current step
        function validateStep(step) {
            let isValid = true;
            let errorMessage = '';
            
            switch(step) {
                case 1:
                    // Check page type is selected
                    const pageType = document.querySelector('input[name="page-type"]:checked');
                    if (!pageType) {
                        isValid = false;
                        errorMessage = '请选择一个页面基础类型';
                    }
                    break;
                    
                case 2:
                    // No validation needed for cluster (optional)
                    break;
                    
                case 3:
                    // No validation needed for classification (optional)
                    break;
                    
                case 4:
                    // No validation needed for special categories (optional)
                    break;
            }
            
            if (!isValid) {
                statusMessage.textContent = '错误: ' + errorMessage;
                statusMessage.className = 'status error';
                setTimeout(() => {
                    statusMessage.textContent = '';
                    statusMessage.className = 'status';
                }, 3000);
                return false;
            }
            
            return true;
        }
        
        // Update step indicator
        function updateStepIndicator() {
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                
                if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else if (index + 1 < currentStep) {
                    step.classList.add('completed');
                }
            });
        }
        
        // Generate categories function
        function generateCategories() {
            // Clear previous status message
            statusMessage.textContent = '';
            statusMessage.className = 'status';
            
            // Start building the categories
            let categories = [];
            
            // Add comment header
            categories.push('<!-- 页面分类开始 -->');
            categories.push('');
            
            // 1. Add page type
            const pageType = document.querySelector('input[name="page-type"]:checked');
            categories.push('<!-- 页面基础类型 -->');
            categories.push(`[[Category:${pageType.value}]]`);
            categories.push('');
            
            // 2. Add cluster affiliations
            const clusterCheckboxes = document.querySelectorAll('input[name="cluster"]:checked');
            if (clusterCheckboxes.length > 0) {
                categories.push('<!-- 层群归属 -->');
                clusterCheckboxes.forEach(checkbox => {
                    if (checkbox.value === 'other') {
                        // Parse custom cluster input
                        const customClusters = parseCustomInput(otherClusterInput.value);
                        customClusters.forEach(cluster => {
                            categories.push(`[[Category:${cluster}]]`);
                        });
                    } else {
                        categories.push(`[[Category:${checkbox.value}]]`);
                    }
                });
                categories.push('');
            }
            
            // 3. Add object classifications if any selected
            const classificationGroups = document.querySelectorAll('.classification-group');
            let hasClassifications = false;
            
            classificationGroups.forEach(group => {
                if (!group.classList.contains('hidden')) {
                    const checkboxes = group.querySelectorAll('input[type="checkbox"]:checked');
                    if (checkboxes.length > 0) {
                        if (!hasClassifications) {
                            categories.push('<!-- 对象分级 -->');
                            hasClassifications = true;
                        }
                        
                        checkboxes.forEach(cb => {
                            categories.push(`[[Category:${cb.value}]]`);
                        });
                    }
                }
            });
            
            // Add special classification if provided
            const specialClassification = specialClassificationInput.value.trim();
            if (specialClassification) {
                if (!hasClassifications) {
                    categories.push('<!-- 对象分级 -->');
                    hasClassifications = true;
                }
                
                const parsedSpecial = parseCustomInput(specialClassification);
                parsedSpecial.forEach(item => {
                    categories.push(`[[Category:${item}]]`);
                });
            }
            
            if (hasClassifications) {
                categories.push('');
            }
            
            // 4. Add special categories if provided
            const specialCategories = specialCategoriesInput.value.trim();
            if (specialCategories) {
                categories.push('<!-- 特殊分类 -->');
                const parsedSpecialCategories = parseCustomInput(specialCategories);
                parsedSpecialCategories.forEach(item => {
                    categories.push(`[[Category:${item}]]`);
                });
                categories.push('');
            }
            
            // Add comment footer
            categories.push('<!-- 页面分类结束 -->');
            
            // Display the result
            resultCode.textContent = categories.join('\n');
            
            // Show success message
            statusMessage.textContent = '分类代码生成成功！';
            statusMessage.className = 'status success';
        }
        
        // Parse custom input for categories
        function parseCustomInput(input) {
            if (!input.trim()) return [];
            
            // Split by comma or newline
            const items = input.split(/[,\n]/);
            const result = [];
            
            items.forEach(item => {
                const trimmed = item.trim();
                if (trimmed) {
                    // Remove any existing [[Category:...]] wrapper
                    const cleanName = trimmed.replace(/^\[\[Category:(.*)\]\]$/, '$1');
                    result.push(cleanName);
                }
            });
            
            return result;
        }
        
        // Copy to clipboard function
        function copyToClipboard() {
            if (!resultCode.textContent || resultCode.textContent.startsWith('//')) {
                statusMessage.textContent = '错误: 请先生成分类代码';
                statusMessage.className = 'status error';
                return;
            }
            
            // Select the text
            const range = document.createRange();
            range.selectNodeContents(resultCode);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            
            // Copy to clipboard
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    statusMessage.textContent = '分类代码已复制到剪贴板！';
                    statusMessage.className = 'status success';
                } else {
                    throw new Error('复制失败');
                }
            } catch (err) {
                statusMessage.textContent = '错误: 无法复制到剪贴板，请手动选择并复制';
                statusMessage.className = 'status error';
            }
            
            // Deselect the text
            selection.removeAllRanges();
        }
        
        // Reset form function
        function resetForm() {
            // Reset all checkboxes and radio buttons
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });
            
            document.querySelectorAll('input[type="radio"]').forEach(rb => {
                rb.checked = false;
            });
            
            // Reset all text inputs and textareas
            document.querySelectorAll('input[type="text"], textarea').forEach(input => {
                input.value = '';
            });
            
            // Hide classification groups
            survivalDifficulty.classList.add('hidden');
            itemClassification.classList.add('hidden');
            entityClassification.classList.add('hidden');
            
            // Hide other cluster container
            otherClusterContainer.classList.add('hidden');
            
            // Hide cluster warning
            clusterWarning.classList.add('hidden');
            
            // Reset steps
            currentStep = 1;
            updateStepIndicator();
            
            // Hide all step sections except first
            stepSections.forEach((section, index) => {
                if (index === 0) {
                    section.classList.remove('hidden');
                } else {
                    section.classList.add('hidden');
                }
            });
            
            // Hide result section
            stepSections[4].classList.add('hidden');
            
            // Reset buttons
            generateBtn.style.display = 'inline-block';
            generateBtn.textContent = '下一步';
            prevBtn.style.display = 'none';
            
            // Reset result code
            resultCode.textContent = '// 请选择分类选项，然后点击"生成分类代码"按钮\n// 生成的内容将显示在这里';
            
            // Clear status message
            statusMessage.textContent = '';
            statusMessage.className = 'status';
            
            // Show success message
            statusMessage.textContent = '表单已重置';
            statusMessage.className = 'status success';
            setTimeout(() => {
                statusMessage.textContent = '';
                statusMessage.className = 'status';
            }, 2000);
        }
    </script>
</body>
</html>
